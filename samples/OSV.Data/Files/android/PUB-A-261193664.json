{
  "id": "PUB-A-261193664",
  "summary": "Bypass guard of developer options switch to set media transcoding - TranscodeNotificationPreferenceController",
  "details": "In getAvailabilityStatus of several Transcode Permission Controllers, there is a possible permission bypass due to a missing permission check. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.",
  "aliases": [
    "A-261193664",
    "CVE-2023-21004"
  ],
  "modified": "2024-08-29T06:58:05.084444Z",
  "published": "2023-03-01T00:00:00Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://source.android.com/security/bulletin/2023-03-01"
    },
    {
      "type": "FIX",
      "url": "https://android.googlesource.com/platform/packages/apps/Settings/+/49cd8d88d1911dc4a54545f4dadb8a36e9897195"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "platform/packages/apps/Settings",
        "ecosystem": "Android"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "13:0"
            },
            {
              "fixed": "13:2023-03-01"
            }
          ]
        }
      ],
      "versions": [
        "13"
      ],
      "ecosystem_specific": {
        "vanir_signatures": [
          {
            "match_only_versions": [
              "13"
            ],
            "digest": {
              "length": 41.0,
              "function_hash": "236674640356316981490238634542101464405"
            },
            "id": "PUB-A-261193664-203d35ea",
            "source": "https://android.googlesource.com/platform/packages/apps/Settings/+/49cd8d88d1911dc4a54545f4dadb8a36e9897195",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "src/com/android/settings/development/transcode/TranscodeNotificationPreferenceController.java",
              "function": "getAvailabilityStatus"
            },
            "signature_type": "Function"
          },
          {
            "match_only_versions": [
              "13"
            ],
            "digest": {
              "length": 41.0,
              "function_hash": "236674640356316981490238634542101464405"
            },
            "id": "PUB-A-261193664-45815146",
            "source": "https://android.googlesource.com/platform/packages/apps/Settings/+/49cd8d88d1911dc4a54545f4dadb8a36e9897195",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "src/com/android/settings/development/transcode/TranscodeUserControlPreferenceController.java",
              "function": "getAvailabilityStatus"
            },
            "signature_type": "Function"
          },
          {
            "digest": {
              "threshold": 0.9,
              "line_hashes": [
                "239880030475804735525045444825933912466",
                "65704351850078556813809948977535046342",
                "195873909572868069413272498223059350418",
                "268658970141709656488395093631520305436",
                "292715688784288596723357206484415551131",
                "57359629083677711734317689052449970984",
                "17658525698197149359312474093111707770",
                "99229433249471519821989055320866350730"
              ]
            },
            "id": "PUB-A-261193664-4b1605ca",
            "source": "https://android.googlesource.com/platform/packages/apps/Settings/+/49cd8d88d1911dc4a54545f4dadb8a36e9897195",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "src/com/android/settings/development/transcode/TranscodeDefaultOptionPreferenceController.java"
            },
            "signature_type": "Line"
          },
          {
            "digest": {
              "threshold": 0.9,
              "line_hashes": [
                "48768572421316594062312206303639621843",
                "301798775457644447576401298549072058616",
                "150738791912824412530217483185926606827",
                "133403862737260672454793960964894045193",
                "292715688784288596723357206484415551131",
                "57359629083677711734317689052449970984",
                "17658525698197149359312474093111707770",
                "99229433249471519821989055320866350730"
              ]
            },
            "id": "PUB-A-261193664-637b62c5",
            "source": "https://android.googlesource.com/platform/packages/apps/Settings/+/49cd8d88d1911dc4a54545f4dadb8a36e9897195",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "src/com/android/settings/development/transcode/TranscodeDisableCachePreferenceController.java"
            },
            "signature_type": "Line"
          },
          {
            "digest": {
              "threshold": 0.9,
              "line_hashes": [
                "239880030475804735525045444825933912466",
                "62859097913664052776379718640344266149",
                "195155293114913528184689025863770529535",
                "44175000209319174538087884074594626186",
                "292715688784288596723357206484415551131",
                "57359629083677711734317689052449970984",
                "17658525698197149359312474093111707770",
                "268536318218162864781791918005771363384"
              ]
            },
            "id": "PUB-A-261193664-638f1b2c",
            "source": "https://android.googlesource.com/platform/packages/apps/Settings/+/49cd8d88d1911dc4a54545f4dadb8a36e9897195",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "src/com/android/settings/development/transcode/TranscodeGlobalTogglePreferenceController.java"
            },
            "signature_type": "Line"
          },
          {
            "match_only_versions": [
              "13"
            ],
            "digest": {
              "length": 41.0,
              "function_hash": "236674640356316981490238634542101464405"
            },
            "id": "PUB-A-261193664-76cfece1",
            "source": "https://android.googlesource.com/platform/packages/apps/Settings/+/49cd8d88d1911dc4a54545f4dadb8a36e9897195",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "src/com/android/settings/development/transcode/TranscodeGlobalTogglePreferenceController.java",
              "function": "getAvailabilityStatus"
            },
            "signature_type": "Function"
          },
          {
            "match_only_versions": [
              "13"
            ],
            "digest": {
              "length": 41.0,
              "function_hash": "236674640356316981490238634542101464405"
            },
            "id": "PUB-A-261193664-906527a2",
            "source": "https://android.googlesource.com/platform/packages/apps/Settings/+/49cd8d88d1911dc4a54545f4dadb8a36e9897195",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "src/com/android/settings/development/transcode/TranscodeDefaultOptionPreferenceController.java",
              "function": "getAvailabilityStatus"
            },
            "signature_type": "Function"
          },
          {
            "digest": {
              "threshold": 0.9,
              "line_hashes": [
                "48768572421316594062312206303639621843",
                "34849504718725692069715510852686235342",
                "260370935935775650813883337895458227256",
                "131662718029329003361181297774797701169",
                "292715688784288596723357206484415551131",
                "57359629083677711734317689052449970984",
                "17658525698197149359312474093111707770",
                "99229433249471519821989055320866350730"
              ]
            },
            "id": "PUB-A-261193664-921b0a42",
            "source": "https://android.googlesource.com/platform/packages/apps/Settings/+/49cd8d88d1911dc4a54545f4dadb8a36e9897195",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "src/com/android/settings/development/transcode/TranscodeNotificationPreferenceController.java"
            },
            "signature_type": "Line"
          },
          {
            "digest": {
              "threshold": 0.9,
              "line_hashes": [
                "239880030475804735525045444825933912466",
                "298682993907660681430809088245915255082",
                "286521373903989292261427173267641386148",
                "337570814500351384600730464191709818310",
                "292715688784288596723357206484415551131",
                "57359629083677711734317689052449970984",
                "17658525698197149359312474093111707770",
                "99229433249471519821989055320866350730"
              ]
            },
            "id": "PUB-A-261193664-d110270c",
            "source": "https://android.googlesource.com/platform/packages/apps/Settings/+/49cd8d88d1911dc4a54545f4dadb8a36e9897195",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "src/com/android/settings/development/transcode/TranscodeUserControlPreferenceController.java"
            },
            "signature_type": "Line"
          },
          {
            "match_only_versions": [
              "13"
            ],
            "digest": {
              "length": 41.0,
              "function_hash": "236674640356316981490238634542101464405"
            },
            "id": "PUB-A-261193664-f805691c",
            "source": "https://android.googlesource.com/platform/packages/apps/Settings/+/49cd8d88d1911dc4a54545f4dadb8a36e9897195",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "src/com/android/settings/development/transcode/TranscodeDisableCachePreferenceController.java",
              "function": "getAvailabilityStatus"
            },
            "signature_type": "Function"
          }
        ],
        "fixes": [
          "https://android.googlesource.com/platform/packages/apps/Settings/+/49cd8d88d1911dc4a54545f4dadb8a36e9897195"
        ],
        "spl": "2023-03-01",
        "severity": "Moderate",
        "types": [
          "EoP"
        ]
      },
      "database_specific": {
        "source": "https://storage.googleapis.com/android-osv/PUB-A-261193664.json"
      }
    }
  ],
  "schema_version": "1.6.0"
}